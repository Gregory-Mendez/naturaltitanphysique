import{r as a,V as s,j as e,m as o,a5 as p,q as S,K as y,y as j,Q as b,a6 as E,b as _,C as R}from"./vendor-DneCX9Yi.js";import{lumi as x}from"./lumi-ycYV9txU.js";const G=()=>{const[f,m]=a.useState(!1),[g,v]=a.useState(""),[n,N]=a.useState([]),[w,h]=a.useState(!1),[i,d]=a.useState("all");a.useEffect(()=>{localStorage.getItem("adminAuth")==="TitanGryx2024"&&(m(!0),l())},[]);const C=t=>{t.preventDefault(),g==="TitanGryx2024"?(m(!0),localStorage.setItem("adminAuth","TitanGryx2024"),s.success("Accès admin activé"),l()):s.error("Mot de passe incorrect")},l=async()=>{h(!0);try{const t=await x.entities.access_codes.list({sort:{createdAt:-1},limit:100});N(t.list)}catch(t){console.error("Error fetching codes:",t),s.error("Erreur lors du chargement des codes")}finally{h(!1)}},k=async t=>{try{await x.entities.access_codes.update(t,{status:"revoked"}),s.success("Code révoqué"),l()}catch(c){console.error("Error revoking code:",c),s.error("Erreur lors de la révocation")}},A=async t=>{try{await x.entities.access_codes.update(t,{status:"active"}),s.success("Code réactivé"),l()}catch(c){console.error("Error reactivating code:",c),s.error("Erreur lors de la réactivation")}},u=n.filter(t=>i==="all"?!0:t.status===i),r={total:n.length,active:n.filter(t=>t.status==="active").length,revoked:n.filter(t=>t.status==="revoked").length};return f?e.jsx("div",{className:"min-h-screen bg-gray-900 py-12 px-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs(o.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-red-600 to-green-600 p-3 rounded-xl",children:e.jsx(p,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Gestion Admin"}),e.jsx("p",{className:"text-gray-400",children:"Codes d'accès clients"})]})]}),e.jsx("button",{onClick:l,className:"bg-gray-700 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium transition-all",children:"Actualiser"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-gray-800 p-4 rounded-xl border border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Total"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:r.total})]}),e.jsx(y,{className:"w-8 h-8 text-gray-500"})]})}),e.jsx("div",{className:"bg-gray-800 p-4 rounded-xl border border-green-600",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Actifs"}),e.jsx("p",{className:"text-3xl font-bold text-green-500",children:r.active})]}),e.jsx(j,{className:"w-8 h-8 text-green-500"})]})}),e.jsx("div",{className:"bg-gray-800 p-4 rounded-xl border border-red-600",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Révoqués"}),e.jsx("p",{className:"text-3xl font-bold text-red-500",children:r.revoked})]}),e.jsx(b,{className:"w-8 h-8 text-red-500"})]})})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("button",{onClick:()=>d("all"),className:`px-4 py-2 rounded-lg font-medium transition-all ${i==="all"?"bg-gradient-to-r from-red-600 to-green-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:["Tous (",r.total,")"]}),e.jsxs("button",{onClick:()=>d("active"),className:`px-4 py-2 rounded-lg font-medium transition-all ${i==="active"?"bg-green-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:["Actifs (",r.active,")"]}),e.jsxs("button",{onClick:()=>d("revoked"),className:`px-4 py-2 rounded-lg font-medium transition-all ${i==="revoked"?"bg-red-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:["Révoqués (",r.revoked,")"]})]})]}),w?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-red-600 border-t-transparent rounded-full mx-auto"}),e.jsx("p",{className:"text-gray-400 mt-4",children:"Chargement..."})]}):u.length===0?e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-12 text-center",children:[e.jsx(E,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"Aucun code trouvé"})]}):e.jsx("div",{className:"space-y-4",children:u.map(t=>e.jsx(o.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:`bg-gray-800 p-6 rounded-xl border-2 ${t.status==="active"?"border-green-600":"border-red-600"}`,children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-bold ${t.status==="active"?"bg-green-600 text-white":"bg-red-600 text-white"}`,children:t.status==="active"?"ACTIF":"RÉVOQUÉ"}),e.jsx("span",{className:"bg-gray-700 px-4 py-1 rounded-lg font-mono text-white text-lg font-bold",children:t.code})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx(_,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{children:t.email})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx(y,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:t.planId==="premium_app_monthly"?"6,99€/mois":"49€/an"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx(R,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{children:new Date(t.createdAt).toLocaleDateString("fr-FR",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]}),e.jsx("div",{className:"flex gap-2",children:t.status==="active"?e.jsxs("button",{onClick:()=>k(t._id),className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4"}),"Révoquer"]}):e.jsxs("button",{onClick:()=>A(t._id),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-all flex items-center gap-2",children:[e.jsx(j,{className:"w-4 h-4"}),"Réactiver"]})})]})},t._id))})]})}):e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center px-4",children:e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gray-800 p-8 rounded-xl border-2 border-red-600 max-w-md w-full",children:[e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsx("div",{className:"bg-gradient-to-r from-red-600 to-green-600 p-4 rounded-full",children:e.jsx(p,{className:"w-12 h-12 text-white"})})}),e.jsx("h2",{className:"text-2xl font-bold text-white text-center mb-6",children:"Admin - Gestion des Codes"}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-300 mb-2 font-medium",children:[e.jsx(S,{className:"inline w-4 h-4 mr-2"}),"Mot de passe admin"]}),e.jsx("input",{type:"password",value:g,onChange:t=>v(t.target.value),className:"w-full px-4 py-3 bg-gray-700 text-white rounded-lg border border-gray-600 focus:border-red-500 focus:outline-none",placeholder:"TitanGryx2024",required:!0})]}),e.jsx("button",{type:"submit",className:"w-full bg-gradient-to-r from-red-600 to-green-600 text-white py-3 rounded-lg font-bold hover:shadow-lg transition-all",children:"Se connecter"})]})]})})};export{G as default};
